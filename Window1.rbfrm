#tag WindowBegin Window Window1   BackColor       =   &hFFFFFF   Backdrop        =   ""   CloseButton     =   True   Composite       =   False   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   4.55e+2   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   1581359147   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   True   Title           =   "Untitled"   Visible         =   True   Width           =   1.084e+3   Begin Canvas Canvas1      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   389      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Top             =   14      UseFocusRing    =   True      Visible         =   True      Width           =   516   End   Begin Canvas Canvas2      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   389      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   548      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Top             =   14      UseFocusRing    =   True      Visible         =   True      Width           =   516   End   Begin PushButton PushButton1      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "test"      Default         =   True      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   415      Underline       =   ""      Visible         =   True      Width           =   80   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Open()		  p1=New Picture(Macau.Width, Macau.Height, 32)		  		  p1.Graphics.DrawPicture Macau, 0, 0		  		  		End Sub	#tag EndEvent	#tag Property, Flags = &h0		p1 As Picture	#tag EndProperty	#tag Property, Flags = &h0		p2 As Picture	#tag EndProperty#tag EndWindowCode#tag Events Canvas1	#tag Event		Sub Paint(g As Graphics)		  If p1=Nil Then Return		  		  g.DrawPicture p1,0,0		End Sub	#tag EndEvent#tag EndEvents#tag Events Canvas2	#tag Event		Sub Paint(g As Graphics)		  If p2=Nil Then Return		  		  g.DrawPicture p2,0,0		End Sub	#tag EndEvent#tag EndEvents#tag Events PushButton1	#tag Event		Sub Action()		  Dim x As SteganoFS		  x=new SteganoFS(p1)		  		  If Not x.AddText("This is string one") Then		    MsgBox "No space for string 0"		    Return		  End if		  		  If Not x.AddText("This is string two") Then		    MsgBox "No space for string 1"		    Return		  End if		  		  If Not x.AddText("This is string three") Then		    MsgBox "No space for string 2"		    Return		  End if		  		  Dim p As Picture		  		  p=New Picture(128,128,32)		  p.Graphics.ForeColor=&c00FF00		  p.Graphics.FillRect(0,0,128,128)		  p.Graphics.Pixel(15,15)=&c0000ff		  		  If Not x.AddPicture(p) Then		    MsgBox "No space for picture p0"		    Return		  End if		  		  p=New Picture(128,128,32)		  p.Graphics.ForeColor=&cfff000		  p.Graphics.FillRect(0,0,128,128)		  p.Graphics.Pixel(80,90)=&c000fff		  		  If Not x.AddPicture(p) Then		    MsgBox "No space for picture p1"		    Return		  End if		  		  Dim f As FolderItem		  f=GetFolderItem("stored.png")		  x.Compile()		  x.Store(f)		  		  Dim i, j As Integer		  x=New SteganoFS(f)		  		  x.Stats(i, j)		  MsgBox "Stats"+EndOfLine+EndOfLine+"Pictures: "+Str(i)+EndOfLine+"Texts:"+Str(j)+EndOfLine+Join(x.List, EndOfLine)		  		  Dim pxz As Picture		  f=GetFolderItem("extracted pic 0.jpg")		  pxz=x.Picture(0)		  pxz.Save(f, pxz.SaveAsJPEG, 100)		  		  p2=New Picture(Canvas2.Width, Canvas2.Height, 32)		  p2.Graphics.DrawPicture pxz, 0, 0		  		  f=GetFolderItem("extracted pic 1.jpg")		  pxz=x.Picture(1)		  pxz.Save(f, pxz.SaveAsJPEG, 100)		  		  p2.Graphics.DrawPicture pxz, 130, 0		  		  x.Stats(i, j)		  For i=0 to j		    p2.Graphics.DrawString x.Text(i), 10, (i*30)+158		  Next		  		  Canvas2.Refresh()		  		  		End Sub	#tag EndEvent#tag EndEvents